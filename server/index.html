<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Responsive Music Player</title>
</head>

<body>


   <audio src="" id="audio" controls></audio>



   <button onclick="PLAY()">play</button>


</body>



<script>

   const audio = document.getElementById("audio");

   var currentTrack = {};

   function PLAY() {
      audio.play();
      getTime();
      initTrack();
   }

   function initTrack() {
      audio.src = `Music/${currentTrack.url}`;
      audio.volume = 0.1;
      audio.currentTime = currentTrack.currentTime;
      audio.play();
   }

   async function getCurrentTrack() {
      fetch("/getCurrentTrack")
         .then(response => response.json())
         .then(data => {
            currentTrack = data;
            initTrack();
         });
   }

   async function getTime() {
      fetch("/getTime")
         .then(response => response.json())
         .then(data => {
            console.log(data);
            currentTrack.currentTime = parseInt(data);
         });
   }

   audio.addEventListener('ended', () => {
      console.log("La lecture est termin√©e !");
      // Ici, tu peux lancer la piste suivante ou effectuer une autre action
      getCurrentTrack();
   });

   getCurrentTrack();

</script>

</html>